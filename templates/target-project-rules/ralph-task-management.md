# Ralph 任务管理规范

为了支持 Ralph Loop 的长时间自主运行，项目中的任务必须按照以下规范进行管理。这将确保即使在上下文重置或系统重启后，Agent 也能准确恢复工作。

## 1. 状态文件 (State File)
项目根目录必须包含一个名为 `RALPH_STATE.md` 的文件。

### 格式模板
```markdown
# Ralph 任务状态

## 🎯 总体目标
(在此描述当前的大目标，例如：重构整个认证模块)

## 📋 任务清单
- [x] **Step 1**: 初始化环境 (完成于 2023-10-27 10:00)
- [ ] **Step 2**: 迁移 User 表
  - [ ] 编写 SQL 迁移脚本
  - [ ] 运行迁移测试
- [ ] **Step 3**: 更新 API 接口
- [ ] **Step 4**: 更新前端调用

## 📝 上下文备忘录
(在此记录关键信息，避免因上下文丢失而遗忘)
- 数据库连接字符串在 .env.test 中
- 使用 Jest 进行测试，命令是 `npm test`
- 注意：User 表新增了 `sso_id` 字段

## 🚫 遇到的问题
- (空)
```

## 2. Agent 操作规范

### 2.1 启动时
- **读取** `RALPH_STATE.md`。
- 确认最后一个打钩的任务。
- 读取 "上下文备忘录"。

### 2.2 执行中
- 每完成一个子任务，**立即** 更新 `RALPH_STATE.md` 中的复选框。
- 如果发现新信息（如新的依赖关系），更新 "上下文备忘录"。

### 2.3 结束时
- 确保 `RALPH_STATE.md` 反映了最终状态。
- 如果遇到阻碍，在 "遇到的问题" 节中详细描述，并将 XML 状态设为 `ERROR` 或 `WAITING_USER`。

## 3. 提交规范 (Git Integration)
- 建议每完成一个 Step 就进行一次 Git Commit。
- Commit Message 格式: `feat(ralph): [Step 2] 迁移 User 表`。
- 这样即使 `RALPH_STATE.md` 损坏，也可以通过 Git 历史恢复进度。
